# REQ-033: PDFフォーマット定義

## メタ情報

| 項目 | 値 |
|---|---|
| ステータス | done |
| 優先度 | 低 |
| 依存 | なし |
| 作成日 | 2026-02-06 |
| 更新日 | 2026-02-06 |

## 背景・動機

PDFはバイナリとテキストが混在するフォーマットだが、ファイルヘッダ、クロスリファレンステーブル、トレーラ等のバイナリ構造部分はBinAnalyzerで解析可能。

PDFの構造を理解するための最初のステップとして、ヘッダとファイル末尾のトレーラ構造を解析できるフォーマット定義を作成する。

## 機能要件

### 追加する機能

- [ ] `formats/pdf.bdef.yaml` フォーマット定義
  - PDFヘッダ（バージョン文字列 `%PDF-x.y`）
  - バイナリコメント行（高ビットバイト4つ）
  - ファイル末尾のstartxrefオフセット値（可能な範囲で）
- [ ] 解析範囲の明確化
  - PDFはストリームベースの構造を持つため、全体の完全解析は不可能
  - ヘッダ部分（先頭数十バイト）の構造解析に限定

### 変更する既存機能

なし（YAMLファイルの追加のみ）。

### 変更しないもの（スコープ外）

- PDFオブジェクトの解析（間接オブジェクト、ストリーム）
- クロスリファレンステーブルの完全解析（テキストベースのため）
- ページコンテンツの解析
- 暗号化PDFの対応

## 受入条件

1. [ ] `formats/pdf.bdef.yaml` が存在すること
2. [ ] PDFヘッダ（`%PDF-x.y`）が解析できること
3. [ ] バイナリコメント行が解析できること
4. [ ] 有効なPDFファイルでデコードエラーにならないこと
5. [ ] フォーマット定義がバリデーションに通ること
6. [ ] 既存テストが全て通過すること

## 影響範囲

### 変更が必要なプロジェクト

| プロジェクト | 変更内容の概要 |
|---|---|
| BinAnalyzer.Core | 変更なし |
| BinAnalyzer.Dsl | 変更なし |
| BinAnalyzer.Engine | 変更なし |
| BinAnalyzer.Output | 変更なし |
| BinAnalyzer.Cli | 変更なし |

### 変更が必要なドキュメント

- [ ] docs/architecture.md — formats/ ディレクトリに pdf.bdef.yaml を追記
- [ ] README.md — 対応フォーマットにPDFを追記（限定的であることを注記）

---

## 設計メモ

> 設計Phaseで記入する。

---

## 実装メモ

> 実装Phaseで記入する。

### 実装中の設計変更

### 追加したテスト

| テストクラス | テスト名 | 対応する受入条件 |
|---|---|---|
| | | |

### 気づき・今後の課題
